import random
import time
import os
from colorama import Fore, Back, Style, init

# рдХрд▓рд░реНрд╕ рдПрдХреНрдЯрд┐рд╡реЗрдЯ рдХрд░рдирд╛
init(autoreset=True)

class UltimateQuizApp:
    def __init__(self):
        # 6 рд╡рд┐рд╖рдп рдЬреЛ рдЖрдкрдиреЗ рдмрддрд╛рдП
        self.subjects = ["рд╣рд┐рдВрджреА", "рдЕрдВрдЧреНрд░реЗрдЬреА", "рд╕рд╛рдорд╛рдЬрд┐рдХ рд╡рд┐рдЬреНрдЮрд╛рди", "рд╡рд┐рдЬреНрдЮрд╛рди", "рдЧрдгрд┐рдд", "рд╕рдВрд╕реНрдХреГрдд"]
        
        # рдпрд╣рд╛рдБ рдЖрдк рдЕрдкрдиреЗ 500 рдкреНрд░рд╢реНрди рднрд░ рд╕рдХрддреЗ рд╣реИрдВ
        # рдбреЗрдореЛ рдХреЗ рд▓рд┐рдП рд╣рд░ рд╕рдмреНрдЬреЗрдХреНрдЯ рдореЗрдВ 20+ рдкреНрд░рд╢реНрди рд░рдЦреЗ рдЧрдП рд╣реИрдВ
        self.db = {sub: self.load_questions(sub) for sub in self.subjects}
        
        self.score = 0
        self.correct = 0
        self.wrong = 0
        self.skipped = 0
        self.total_attempted = 0

    def load_questions(self, subject):
        # рдкреНрд░рд╢реНрди рдмреИрдВрдХ рдХрд╛ рдврд╛рдВрдЪрд╛ (рдЗрд╕реЗ рдЖрдк 500 рддрдХ рдмреЭрд╛ рд╕рдХрддреЗ рд╣реИрдВ)
        q_list = []
        for i in range(1, 51): # рдбреЗрдореЛ рдХреЗ рд▓рд┐рдП 50 рдкреНрд░рд╢реНрди рдкреНрд░рддрд┐ рд╡рд┐рд╖рдп
            q_list.append({
                "question": f"{subject} рдХрд╛ рдорд╣рддреНрд╡рдкреВрд░реНрдг рдкреНрд░рд╢реНрди рд╕рдВрдЦреНрдпрд╛ {i}?",
                "options": [f"рд╕рд╣реА рдЬрд╡рд╛рдм {i}", f"рдЧрд▓рдд рд╡рд┐рдХрд▓реНрдк A", f"рдЧрд▓рдд рд╡рд┐рдХрд▓реНрдк B", f"рдЧрд▓рдд рд╡рд┐рдХрд▓реНрдк C"],
                "answer": f"рд╕рд╣реА рдЬрд╡рд╛рдм {i}"
            })
        return q_list

    def clear(self):
        os.system('clear')

    def header(self):
        print(Fore.YELLOW + Style.BRIGHT + "="*45)
        print(Fore.CYAN + Style.BRIGHT + "       SMART STUDENT QUIZ PRO 2026       ")
        print(Fore.YELLOW + Style.BRIGHT + "="*45)

    def main_menu(self):
        self.clear()
        self.header()
        print(Fore.WHITE + "\nрдЕрдкрдирд╛ рд╡рд┐рд╖рдп рдЪреБрдиреЗрдВ:")
        for idx, sub in enumerate(self.subjects, 1):
            print(f"{Fore.GREEN}{idx}. {sub}")
        
        try:
            choice = int(input(Fore.YELLOW + "\nрдирдВрдмрд░ рдЪреБрдиреЗрдВ (1-6): ")) - 1
            if 0 <= choice < 6:
                self.start_quiz(self.subjects[choice])
            else:
                print("рдЧрд▓рдд рдЪреБрдирд╛рд╡!")
                time.sleep(1)
                self.main_menu()
        except ValueError:
            self.main_menu()

    def start_quiz(self, subject):
        # 500 рдореЗрдВ рд╕реЗ 15 рдкреНрд░рд╢реНрди рд░реИрдВрдбрдорд▓реА рдЪреБрдирдирд╛
        selected_qs = random.sample(self.db[subject], 15)
        
        for i, q_data in enumerate(selected_qs, 1):
            self.clear()
            print(Fore.MAGENTA + f"рд╡рд┐рд╖рдп: {subject} | рдкреНрд░рд╢реНрди: {i}/15")
            print(Fore.BLUE + "-"*45)
            print(Fore.WHITE + Style.BRIGHT + f"Q{i}: {q_data['question']}")
            
            # рдСрдкреНрд╢рдВрд╕ рдХреА рд╢рдлрд▓рд┐рдВрдЧ (рд╣рд░ рдмрд╛рд░ рдЕрд▓рдЧ рдХреНрд░рдо)
            options = list(q_data['options'])
            random.shuffle(options)
            
            for idx, opt in enumerate(options, 1):
                print(f"{Fore.CYAN}{idx}. {opt}")
            
            print(Fore.BLACK + Back.WHITE + "\n[S] SKIP | [Q] SUBMIT & QUIT")
            user_input = input(Fore.YELLOW + "\nрдЖрдкрдХрд╛ рдЙрддреНрддрд░: ").upper()

            if user_input == 'Q':
                break
            if user_input == 'S':
                self.skipped += 1
                continue

            try:
                selected_opt = options[int(user_input)-1]
                self.total_attempted += 1
                
                # рд╡рд┐рдЬреБрдЕрд▓ рдлреАрдбрдмреИрдХ: рд╕рд╣реА (рд╣рд░рд╛) рдФрд░ рдЧрд▓рдд (рд▓рд╛рд▓)
                if selected_opt == q_data['answer']:
                    print(Back.GREEN + Fore.BLACK + "\n  рд╕рд╣реА рдЬрд╡рд╛рдм! тЬЕ  ")
                    self.correct += 1
                    self.score += 4
                    time.sleep(0.5) # 0.5 рд╕реЗрдХрдВрдб рдореЗрдВ рдЕрдЧрд▓рд╛ рдкреНрд░рд╢реНрди
                else:
                    print(Back.RED + Fore.WHITE + f"\n  рдЧрд▓рдд! рд╕рд╣реА рдЙрддреНрддрд░: {q_data['answer']} тЭМ  ")
                    self.wrong += 1
                    time.sleep(1.5)
            except:
                print(Fore.RED + "рдЧрд▓рдд рдЗрдирдкреБрдЯ! рдкреНрд░рд╢реНрди рд╕реНрдХрд┐рдк рд╣реЛ рдЧрдпрд╛ред")
                time.sleep(1)

        self.final_report()

    def final_report(self):
        self.clear()
        self.header()
        total = self.total_attempted if self.total_attempted > 0 else 1
        accuracy = (self.correct / total) * 100 # рдПрдХреНрдпреВрд░реЗрд╕реА рд▓реЙрдЬрд┐рдХ
        
        print(Fore.WHITE + "\n--- рдЖрдкрдХреА рд░рд┐рдкреЛрд░реНрдЯ рдХрд╛рд░реНрдб ---")
        print(f"рдХреБрд▓ рдкреНрд░рд╢реНрди рд╣рд▓ рдХрд┐рдП: {self.total_attempted}")
        print(f"рд╕рд╣реА: {Fore.GREEN}{self.correct}")
        print(f"рдЧрд▓рдд: {Fore.RED}{self.wrong}")
        print(f"рд╕реНрдХрд┐рдк рдХрд┐рдП: {Fore.YELLOW}{self.skipped}")
        print(f"рдПрдХреНрдпреВрд░реЗрд╕реА: {Fore.CYAN}{accuracy:.2f}%") #

        # рд░реИрдВрдХ рд╕рд┐рд╕реНрдЯрдо
        if accuracy >= 90: rank = "TOPPER (Rank 1) ЁЯеЗ"
        elif accuracy >= 75: rank = "EXPERT (Rank 2) ЁЯеИ"
        elif accuracy >= 50: rank = "AVERAGE (Rank 3) ЁЯеЙ"
        else: rank = "BEGINNER (Needs Practice)"
        
        print(Style.BRIGHT + Fore.MAGENTA + f"\nрдЖрдкрдХреА рд░реИрдВрдХ: {rank}")
        print(Fore.YELLOW + "="*45)
        input("\nрдореБрдЦреНрдп рдореЗрдиреВ рдкрд░ рдЬрд╛рдиреЗ рдХреЗ рд▓рд┐рдП Enter рджрдмрд╛рдПрдВ...")
        self.main_menu()

if __name__ == "__main__":
    app = UltimateQuizApp()
    app.main_menu()
